# ЁЯдЦ Walkie-Master: Agent System Deep Dive

р╣Ар╕нр╕Бр╕кр╕▓р╕гр╕Йр╕Ър╕▒р╕Ър╕Щр╕╡р╣Йр╕нр╕Шр╕┤р╕Ър╕▓р╕вр╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Бр╕ер╕░р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Вр╕нр╕Зр╣Вр╕бр╕Фр╕╣р╕ер╕Хр╣Ир╕▓р╕З р╣Ж р╣Гр╕Щр╕гр╕░р╕Ър╕Ър╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣М Walkie р╕кр╕│р╕лр╕гр╕▒р╕Ър╣Ар╕Хр╕гр╕╡р╕вр╕бр╕Др╕зр╕▓р╕бр╕Юр╕гр╣Йр╕нр╕бр╕кр╕╣р╣Ир╕Бр╕▓р╕гр╣Бр╕Вр╣Ир╕Зр╕Вр╕▒р╕Щ **Robocup@home 2026**

---

## 1. Vision Agent (The Eyes) ЁЯСБя╕П

р╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Вр╕ер╕Бр╕ар╕▓р╕вр╕Щр╕нр╕Бр╕Ьр╣Ир╕▓р╕Щр╕ар╕▓р╕Юр╣Бр╕ер╕░р╕зр╕┤р╕Фр╕╡р╣Вр╕н

* **р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕лр╕ер╕▒р╕Б:** WebRTC (aiortc), OpenCV, CLIP (OpenAI), InsightFace
* **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕лр╕ер╕▒р╕Б:**
* **Streamer:** р╕Фр╕╢р╕Зр╕ар╕▓р╕Юр╕кр╕Фр╕Ир╕▓р╕Бр╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣Мр╕Ьр╣Ир╕▓р╕Щр╣Вр╕Ыр╕гр╣Вр╕Хр╕Др╕нр╕е WebRTC (Latency р╕Хр╣Ир╕│)
* **Face Identifier:** р╕Хр╕гр╕зр╕Ир╕Ир╕▒р╕Ър╣Бр╕ер╕░р╕кр╕Бр╕▒р╕Ф Face Embedding (128-512 р╕бр╕┤р╕Хр╕┤) р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╣Ир╕Зр╣Гр╕лр╣Й People DB
* **Object Encoder:** р╣Гр╕Кр╣Й CLIP р╕лр╕гр╕╖р╕н YOLO р╣Ар╕Юр╕╖р╣Ир╕нр╕гр╕░р╕Ър╕╕р╕зр╕▒р╕Хр╕Цр╕╕р╣Бр╕ер╕░р╕кр╕гр╣Йр╕▓р╕З Image Embedding р╕кр╕│р╕лр╕гр╕▒р╕Ъ Object DB
* **Spatial Mapper:** р╕Др╕│р╕Щр╕зр╕Ур╕гр╕░р╕вр╕░р╕лр╣Ир╕▓р╕Зр╕зр╕▒р╕Хр╕Цр╕╕р╕Ир╕▓р╕Бр╕Юр╕┤р╕Бр╕▒р╕Фр╕Др╕зр╕▓р╕бр╕ер╕╢р╕Б (Depth) р╣Ар╕Юр╕╖р╣Ир╕нр╣Бр╕Ыр╕ер╕Зр╣Ар╕Ыр╣Зр╕Щр╕Юр╕┤р╕Бр╕▒р╕Ф XYZ р╣Гр╕Щр╣Вр╕ер╕Бр╕Ир╕гр╕┤р╕З


* **р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ:** р╣Гр╕Кр╣Й `test_webrtc_camera.py` р╣Бр╕ер╕░ `webrtc_test_server.py` р╣Гр╕Щр╕Бр╕▓р╕гр╕Ир╕│р╕ер╕нр╕Зр╕кр╕▒р╕Нр╕Нр╕▓р╕Ур╕ар╕▓р╕Ю

---

## 2. Memory Agent (The Brain - Storage) ЁЯза

р╕Чр╕│р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╣Ар╕Бр╣Зр╕Ър╣Бр╕ер╕░р╕кр╕╖р╕Ър╕Др╣Йр╕Щр╕Др╕зр╕▓р╕бр╕Ир╕│р╕гр╕░р╕вр╕░р╕вр╕▓р╕з (Long-term Memory) р╕Вр╕нр╕Зр╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣М

* **р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕лр╕ер╕▒р╕Б:** ChromaDB (Vector Database)
* **р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З (Standalone Architecture):**
* **ObjectDB:** р╕Ир╕│р╣Бр╕Щр╕Бр╕зр╕▒р╕Хр╕Цр╕╕р╕Хр╕▓р╕б "р╕гр╕╣р╕Ыр╕гр╣Ир╕▓р╕Зр╕лр╕Щр╣Йр╕▓р╕Хр╕▓" (Vector Similarity) р╣Бр╕ер╕░р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Чр╕╡р╣Ир╣Ар╕Др╕вр╣Ар╕лр╣Зр╕Щ
* **PeopleDB:** р╕Ир╕Фр╕Ир╕│р╣Гр╕Ър╕лр╕Щр╣Йр╕▓р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╣Ир╕зр╕Щр╕Ър╕╕р╕Др╕Др╕е (Semantic Info) р╕Вр╕нр╕Зр╣Ар╕Ир╣Йр╕▓р╕Вр╕нр╕Зр╕Ър╣Йр╕▓р╕Щр╕лр╕гр╕╖р╕нр╣Бр╕Вр╕Б
* **SceneDB:** р╕Ир╕Фр╕Ир╕│р╕Юр╕┤р╕Бр╕▒р╕Фр╕кр╕Цр╕▓р╕Щр╕Чр╕╡р╣Ир╕кр╕│р╕Др╕▒р╕Н (Semantic Locations) р╣Ар╕Кр╣Ир╕Щ "р╕лр╣Йр╕нр╕Зр╕Др╕гр╕▒р╕з", "р╕Ыр╕гр╕░р╕Хр╕╣р╕лр╕Щр╣Йр╕▓р╕Ър╣Йр╕▓р╕Щ" р╣Вр╕Фр╕вр╕нр╕┤р╕Зр╕Ир╕▓р╕Б SLAM


* **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕лр╕ер╕▒р╕Б:**
* **Upserting:** р╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕лр╕бр╣Ир╕Чр╕▒р╕Щр╕Чр╕╡р╕Чр╕╡р╣И Vision Agent р╕Хр╕гр╕зр╕Ир╕Юр╕Ъ
* **Querying:** р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╕нр╕Зр╕лр╕гр╕╖р╕нр╕Др╕Щр╕Фр╣Йр╕зр╕вр╕ар╕▓р╕Ю р╕лр╕гр╕╖р╕нр╕Др╣Йр╕Щр╕лр╕▓р╕лр╣Йр╕нр╕Зр╕Чр╕╡р╣Ир╣Гр╕Бр╕ер╣Йр╕Чр╕╡р╣Ир╕кр╕╕р╕Фр╕Ир╕▓р╕Бр╕Юр╕┤р╕Бр╕▒р╕Фр╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ


* **р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ:** р╣Гр╕Кр╣Й `test_db.py` р╕Юр╕гр╣Йр╕нр╕бр╕гр╕░р╕Ър╕Ъ `test_db_path` Sandbox

---

## 3. Planning Agent (The Thinker) ЁЯТн

р╕кр╣Ир╕зр╕Щр╕Ыр╕гр╕░р╕бр╕зр╕ер╕Ьр╕ер╕гр╕░р╕Фр╕▒р╕Ър╕кр╕╣р╕Зр╕Чр╕╡р╣Ир╕Др╕зр╕Ър╕Др╕╕р╕б Logic р╕Бр╕▓р╕гр╕Чр╕│р╕Зр╕▓р╕Щр╕Чр╕▒р╣Йр╕Зр╕лр╕бр╕Ф

* **р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕лр╕ер╕▒р╕Б:** LangChain, LangGraph, Gemini API
* **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕лр╕ер╕▒р╕Б:**
* **Task Planning:** р╕Хр╕╡р╕Др╕зр╕▓р╕бр╕Др╕│р╕кр╕▒р╣Ир╕Зр╕бр╕Щр╕╕р╕йр╕вр╣М (Natural Language) р╣Ар╕Кр╣Ир╕Щ "р╣Др╕Ыр╕лр╕вр╕┤р╕Ър╣Бр╕Бр╣Йр╕зр╣Гр╕Щр╕лр╣Йр╕нр╕Зр╕Др╕гр╕▒р╕зр╕бр╕▓р╣Гр╕лр╣Йр╕лр╕Щр╣Ир╕нр╕в"
* **Reasoning:** р╕зр╕┤р╣Ар╕Др╕гр╕▓р╕░р╕лр╣Мр╕зр╣Ир╕▓р╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й Agent р╕Хр╕▒р╕зр╣Др╕лр╕Щр╕Чр╕│р╕Зр╕▓р╕Щ (р╣Ар╕Кр╣Ир╕Щ р╕Хр╣Йр╕нр╕Зр╣Гр╕Кр╣Й SceneDB р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╕лр╣Йр╕нр╕Зр╕Др╕гр╕▒р╕зр╕Бр╣Ир╕нр╕Щ р╣Бр╕ер╣Йр╕зр╕Др╣Ир╕нр╕вр╣Гр╕Кр╣Й ObjectDB р╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕▓р╣Бр╕Бр╣Йр╕з)
* **State Management:** р╣Ар╕Бр╣Зр╕Ър╕кр╕Цр╕▓р╕Щр╕░р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щр╕Вр╕нр╕Зр╕ар╕▓р╕гр╕Бр╕┤р╕Ир╕зр╣Ир╕▓р╕Чр╕│р╕Цр╕╢р╕Зр╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╣Др╕лр╕Щр╣Бр╕ер╣Йр╕зр╕Ьр╣Ир╕▓р╕Щ Graph-based workflow


* **р╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕н:** р╕Чр╕│р╕Зр╕▓р╕Щр╕Ьр╣Ир╕▓р╕Щ `AgentIntegration` р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕▒р╣Ир╕Зр╕Бр╕▓р╕гр╣Вр╕бр╕Фр╕╣р╕ер╕нр╕╖р╣Ир╕Щ р╣Ж

---

## 4. Action Agent (The Muscles) ЁЯТк

р╕кр╣Ир╕зр╕Щр╕Чр╕╡р╣Ир╣Ар╕Ыр╕ер╕╡р╣Ир╕вр╕Щр╕Бр╕▓р╕гр╕Хр╕▒р╕Фр╕кр╕┤р╕Щр╣Гр╕Ир╣Гр╕лр╣Йр╕Бр╕ер╕▓р╕вр╣Ар╕Ыр╣Зр╕Щр╕Бр╕▓р╕гр╣Ар╕Др╕ер╕╖р╣Ир╕нр╕Щр╣Др╕лр╕зр╕Ир╕гр╕┤р╕З

* **р╣Ар╕Чр╕Др╣Вр╕Щр╣Вр╕ер╕вр╕╡р╕лр╕ер╕▒р╕Б:** Walkie SDK (ROS 2 / rosbridge)
* **р╕лр╕Щр╣Йр╕▓р╕Чр╕╡р╣Ир╕лр╕ер╕▒р╕Б:**
* **Navigation:** р╕гр╕▒р╕Ър╕Юр╕┤р╕Бр╕▒р╕Ф XYZ р╕Ир╕▓р╕Б Planning Agent р╣Ар╕Юр╕╖р╣Ир╕нр╕кр╕▒р╣Ир╕Зр╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣Мр╣Ар╕Др╕ер╕╖р╣Ир╕нр╕Щр╕Чр╕╡р╣Ир╣Др╕Ыр╕вр╕▒р╕Зр╕Ир╕╕р╕Фр╕лр╕бр╕▓р╕в
* **Arm & Gripper Control:** р╕Др╕зр╕Ър╕Др╕╕р╕бр╣Бр╕Вр╕Щр╕Бр╕ер╣Ар╕Юр╕╖р╣Ир╕нр╕лр╕вр╕┤р╕Ър╕Ир╕▒р╕Ър╕зр╕▒р╕Хр╕Цр╕╕р╕Хр╕▓р╕бр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Чр╕╡р╣Ир╕гр╕░р╕Ър╕╕
* **Feedback Loop:** р╕кр╣Ир╕Зр╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕ер╕▒р╕Ър╣Др╕Ыр╕вр╕▒р╕З Planning Agent р╕зр╣Ир╕▓ "р╕Цр╕╢р╕Зр╕Чр╕╡р╣Ир╕лр╕бр╕▓р╕вр╣Бр╕ер╣Йр╕з" р╕лр╕гр╕╖р╕н "р╕лр╕вр╕┤р╕Ър╕Вр╕нр╕Зр╕Юр╕ер╕▓р╕Ф"


* **р╕кр╕Цр╕▓р╕Щр╕░р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ:** р╣Гр╕Кр╣Й `test_call_action.py` (Pytest version) р╣Ар╕Юр╕╖р╣Ир╕нр╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕зр╕▓р╕бр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕Зр╕Вр╕нр╕Зр╕Бр╕▓р╕гр╕Вр╕вр╕▒р╕Ър╣Бр╕Вр╕Щр╣Бр╕ер╕░ Gripper

---

## ЁЯФД Interaction Flow: "р╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣Мр╕лр╕▓р╣Бр╕Бр╣Йр╕зр╕Щр╣Йр╕│"

| р╕ер╕│р╕Фр╕▒р╕Ъ | Agent | р╕Бр╕┤р╕Ир╕Бр╕гр╕гр╕б |
| --- | --- | --- |
| 1 | **Planning** | р╕гр╕▒р╕Ър╕Др╕│р╕кр╕▒р╣Ир╕З "Find my cup" р╣Бр╕ер╕░р╕Цр╕▓р╕б **SceneDB** р╕зр╣Ир╕▓ "Kitchen р╕нр╕вр╕╣р╣Ир╣Др╕лр╕Щ?" |
| 2 | **Action** | р╕гр╕▒р╕Ър╕Юр╕┤р╕Бр╕▒р╕Фр╕Ир╕▓р╕Б SceneDB р╣Бр╕ер╕░р╕Вр╕▒р╕Ър╣Ар╕Др╕ер╕╖р╣Ир╕нр╕Щр╕лр╕╕р╣Ир╕Щр╕вр╕Щр╕Хр╣Мр╣Др╕Ыр╕Чр╕╡р╣Ир╕лр╣Йр╕нр╕Зр╕Др╕гр╕▒р╕з |
| 3 | **Vision** | р╣Ар╕бр╕╖р╣Ир╕нр╕Цр╕╢р╕Зр╕Чр╕╡р╣Ир╕лр╕бр╕▓р╕в р╣Ар╕гр╕┤р╣Ир╕б Scan р╕Юр╕╖р╣Йр╕Щр╕Чр╕╡р╣Ир╣Бр╕ер╕░р╕кр╣Ир╕Зр╕ар╕▓р╕Юр╣Гр╕лр╣Й **Object Encoder** |
| 4 | **Memory** | р╕Др╣Йр╕Щр╕лр╕▓р╣Гр╕Щ **ObjectDB** р╕зр╣Ир╕▓ "Vector р╕ар╕▓р╕Юр╕Чр╕╡р╣Ир╣Ар╕лр╣Зр╕Щр╕Хр╕нр╕Щр╕Щр╕╡р╣Й р╕Др╕╖р╕нр╣Бр╕Бр╣Йр╕з (Cup) р╣Гр╕Кр╣Ир╕лр╕гр╕╖р╕нр╣Др╕бр╣И?" |
| 5 | **Action** | р╣Ар╕бр╕╖р╣Ир╕нр╕Юр╕Ър╕Юр╕┤р╕Бр╕▒р╕Фр╕Чр╕╡р╣Ир╣Бр╕Щр╣Ир╕Щр╕нр╕Щ р╕кр╕▒р╣Ир╕З **Arm Agent** р╕Вр╕вр╕▒р╕Ър╣Др╕Ыр╕лр╕вр╕┤р╕Ър╣Бр╕Бр╣Йр╕зр╕Хр╕▓р╕бр╕Юр╕┤р╕Бр╕▒р╕Ф XYZ |

---

## ЁЯЫая╕П Developer Guide (Quick Command)

### р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕Др╕зр╕▓р╕бр╕Ир╕│ (Memory)

uv run pytest packages/walkie-db/tests/test_db.py -v

### р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕ар╕▓р╕Ю (Vision)

# Terminal 1: р╣Ар╕Ыр╕┤р╕Ф Server р╕Ир╕│р╕ер╕нр╕З

uv run python tests/webrtc_test_server.py --source test

# Terminal 2: р╣Ар╕Ыр╕┤р╕Ф Client р╕гр╕▒р╕Ър╕ар╕▓р╕Ю

uv run python tests/test_webrtc_camera.py localhost 8554

### р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕гр╕░р╕Ър╕Ър╕кр╕▒р╣Ир╕Зр╕Бр╕▓р╕г (Action)

uv run pytest packages/walkie-sdk/tests/test_arm_actions.py -v

---

**р╕кр╕гр╕╕р╕Ыр╕кр╕Цр╕▓р╕Щр╕░р╕Ыр╕▒р╕Ир╕Ир╕╕р╕Ър╕▒р╕Щ:**
р╕Хр╕нр╕Щр╕Щр╕╡р╣Йр╣Ар╕гр╕▓р╕Чр╕│р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З **Memory (DB)** р╣Бр╕ер╕░ **Integration Interface** р╣Ар╕кр╕гр╣Зр╕Ир╕кр╕бр╕Ър╕╣р╕гр╕Ур╣Мр╣Бр╕ер╣Йр╕з р╕Вр╕▒р╣Йр╕Щр╕Хр╕нр╕Щр╕Хр╣Ир╕нр╣Др╕Ыр╕Др╕╖р╕нр╕Бр╕▓р╕гр╕Чр╕│р╣Гр╕лр╣Й **Vision Agent** р╕кр╕▓р╕бр╕▓р╕гр╕Цр╕кр╕Бр╕▒р╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕бр╕▓р╕Ыр╣Йр╕нр╕Щр╣Гр╕лр╣Йр╣Ар╕Юр╕╖р╣Ир╕нр╕Щ р╣Ж р╣Др╕Фр╣Йр╕нр╕вр╣Ир╕▓р╕Зр╣Бр╕бр╣Ир╕Щр╕вр╕│р╕Др╕гр╕▒р╕Ъ
